{"version":3,"sources":["observatory/views/cache.cljs"],"mappings":"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","names":["p__12821","map__12822","cljs.core/--destructure-map","cljs.core.get","observatory.views.cache/line-cell","set-index","way-index","line","config","has-data?","state","recent?","and__5000__auto__","js/Date.now","cljs.core/name","e","re-frame.core/dispatch","cljs.core.assoc","p__12823","map__12824","observatory.views.cache/cache-set-row","ways","iter__5480__auto__","s__12826","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__12828","cljs.core/chunk-buffer","i__12827","vec__12829","cljs.core/-nth","cljs.core.nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__12825","cljs.core/chunk-rest","vec__12832","cljs.core/first","cljs.core/cons","cljs.core/rest","way","cljs.core.map_indexed","cljs.core/vector","p__12835","map__12836","observatory.views.cache/cache-level-view","level","cache","sets","stats","visible-sets","cljs.core.take","total-sets","s__12838","b__12840","i__12839","iter__12837","w","cljs.core.range","s__12842","b__12844","i__12843","vec__12845","iter__12841","vec__12848","idx","cache-set","observatory.views.cache/hierarchy-overview","cljs.core/deref","hierarchy","re_frame.core.subscribe","observatory.views.cache/simulation-controls","address-input","cljs.core.atom","p1__12851#","cljs.core/reset!","addr","js/parseInt","js/isNaN","seq__12852","chunk__12853","count__12854","i__12855","c__5525__auto__","cljs.core/chunk-first","cljs.core/next","i","seq__12856","chunk__12857","count__12858","i__12859","_","cljs.core/rand-int","observatory.views.cache/cache-view","cache-state","active-level"],"sourcesContent":["(ns observatory.views.cache\n  \"Cache hierarchy visualization.\n\n   Shows the actual structure of CPU caches:\n   - L1/L2/L3 tabs\n   - Sets displayed as rows\n   - Ways displayed as columns\n   - Each cell is a cache line (clickable)\n\n   Color coding:\n   - Empty (gray) - no data\n   - Valid (blue) - clean data\n   - Modified (orange) - dirty data\n   - Recent access (pulse animation)\"\n  (:require [re-frame.core :as rf]\n            [observatory.state :as state]\n            [observatory.cache :as cache]))\n\n;; =============================================================================\n;; Cache Line Cell\n;; =============================================================================\n\n(defn line-cell\n  \"A single cache line cell. Clickable to inspect.\"\n  [{:keys [set-index way-index line config]}]\n  (let [has-data? (some? line)\n        state (:state line)\n        recent? (and line\n                     (< (- (js/Date.now) (:last-access line 0)) 1000))]\n    [:div.cache-line\n     {:class [(when-not has-data? \"empty\")\n              (when has-data? (name state))\n              (when recent? \"recent\")]\n      :on-click (fn [e]\n                  (.stopPropagation e)\n                  (when has-data?\n                    (rf/dispatch [::state/select\n                                  {:type :cache-line\n                                   :data (assoc line\n                                                :set-index set-index\n                                                :way-index way-index)}])))}\n     (when has-data?\n       [:div.line-content\n        [:div.tag (str \"0x\" (.toString (:tag line) 16))]\n        [:div.state-indicator {:class (name state)}]])]))\n\n;; =============================================================================\n;; Cache Set Row\n;; =============================================================================\n\n(defn cache-set-row\n  \"A single set (row) showing all its ways.\"\n  [{:keys [set-index ways config]}]\n  [:div.cache-set\n   [:div.set-index (str \"Set 0x\" (.toString set-index 16))]\n   [:div.ways\n    (for [[way-index way] (map-indexed vector ways)]\n      ^{:key way-index}\n      [line-cell {:set-index set-index\n                  :way-index way-index\n                  :line (:line way)\n                  :config config}])]])\n\n;; =============================================================================\n;; Cache Level View\n;; =============================================================================\n\n(defn cache-level-view\n  \"View for a single cache level (L1/L2/L3).\"\n  [{:keys [level cache]}]\n  (let [config (:config cache)\n        sets (:sets cache)\n        stats (:stats cache)\n        ;; Only show a subset of sets for large caches\n        visible-sets (take 32 sets)\n        total-sets (count sets)]\n    [:div.cache-level-view\n     [:div.level-header\n      [:h3.level-name (str (name level) \" Cache\")]\n      [:div.level-stats\n       [:span.stat (str (:size-kb config) \"KB\")]\n       [:span.stat (str (:associativity config) \"-way\")]\n       [:span.stat (str (count sets) \" sets\")]\n       [:span.stat (str (:line-size config 64) \"B lines\")]]]\n\n     [:div.level-metrics\n      [:div.metric\n       [:span.label \"Hits\"]\n       [:span.value (:hits stats 0)]]\n      [:div.metric\n       [:span.label \"Misses\"]\n       [:span.value (:misses stats 0)]]\n      [:div.metric\n       [:span.label \"Hit Rate\"]\n       [:span.value\n        (if (pos? (+ (:hits stats 0) (:misses stats 0)))\n          (str (int (* 100 (/ (:hits stats 0)\n                              (+ (:hits stats 0) (:misses stats 0))))) \"%\")\n          \"-\")]]\n      [:div.metric\n       [:span.label \"Evictions\"]\n       [:span.value (:evictions stats 0)]]]\n\n     [:div.way-headers\n      [:div.set-index-header \"Set\"]\n      (for [w (range (:associativity config))]\n        ^{:key w}\n        [:div.way-header (str \"Way \" w)])]\n\n     [:div.sets-container\n      (for [[idx cache-set] (map-indexed vector visible-sets)]\n        ^{:key idx}\n        [cache-set-row {:set-index (:index cache-set)\n                        :ways (:ways cache-set)\n                        :config config}])\n\n      (when (> total-sets (count visible-sets))\n        [:div.truncation-notice\n         (str \"Showing \" (count visible-sets) \" of \" total-sets \" sets. \"\n              \"Scroll or filter to see more.\")])]]))\n\n;; =============================================================================\n;; Cache Hierarchy Overview\n;; =============================================================================\n\n(defn hierarchy-overview\n  \"Visual overview of the full cache hierarchy.\"\n  []\n  (let [hierarchy @(rf/subscribe [::state/cache-hierarchy])]\n    [:div.hierarchy-overview\n     [:svg.hierarchy-diagram {:viewBox \"0 0 400 200\"}\n      ;; CPU\n      [:g.cpu {:transform \"translate(175, 10)\"}\n       [:rect {:width 50 :height 30 :rx 4 :class \"cpu-block\"}]\n       [:text {:x 25 :y 20 :text-anchor \"middle\"} \"CPU\"]]\n\n      ;; L1\n      [:g.l1 {:transform \"translate(150, 60)\"}\n       [:rect {:width 100 :height 25 :rx 3 :class \"cache-block l1\"}]\n       [:text {:x 50 :y 17 :text-anchor \"middle\"} \"L1 (32KB)\"]]\n\n      ;; L2\n      [:g.l2 {:transform \"translate(125, 100)\"}\n       [:rect {:width 150 :height 25 :rx 3 :class \"cache-block l2\"}]\n       [:text {:x 75 :y 17 :text-anchor \"middle\"} \"L2 (256KB)\"]]\n\n      ;; L3\n      [:g.l3 {:transform \"translate(75, 140)\"}\n       [:rect {:width 250 :height 25 :rx 3 :class \"cache-block l3\"}]\n       [:text {:x 125 :y 17 :text-anchor \"middle\"} \"L3 (8MB)\"]]\n\n      ;; RAM\n      [:g.ram {:transform \"translate(25, 180)\"}\n       [:rect {:width 350 :height 15 :rx 2 :class \"ram-block\"}]\n       [:text {:x 175 :y 12 :text-anchor \"middle\"} \"RAM\"]]\n\n      ;; Connecting lines\n      [:path.connection {:d \"M200,40 L200,60\"}]\n      [:path.connection {:d \"M200,85 L200,100\"}]\n      [:path.connection {:d \"M200,125 L200,140\"}]\n      [:path.connection {:d \"M200,165 L200,180\"}]]]))\n\n;; =============================================================================\n;; Cache Simulation Controls\n;; =============================================================================\n\n(defn simulation-controls\n  \"Controls for cache simulation mode.\"\n  []\n  (let [address-input (atom \"0x7ff612340000\")]\n    (fn []\n      [:div.simulation-controls\n       [:h4 \"Simulate Access\"]\n       [:div.input-row\n        [:input.address-input\n         {:type \"text\"\n          :value @address-input\n          :on-change #(reset! address-input (-> % .-target .-value))\n          :placeholder \"Enter address (hex)\"}]\n        [:button.simulate-btn\n         {:on-click #(let [addr (js/parseInt @address-input 16)]\n                       (when-not (js/isNaN addr)\n                         (rf/dispatch [::state/simulate-access addr])))}\n         \"Access\"]]\n       [:div.quick-patterns\n        [:span.label \"Quick patterns:\"]\n        [:button.pattern-btn\n         {:on-click #(doseq [i (range 100)]\n                       (rf/dispatch [::state/simulate-access (+ 0x1000 (* i 64))]))}\n         \"Sequential\"]\n        [:button.pattern-btn\n         {:on-click #(doseq [_ (range 100)]\n                       (rf/dispatch [::state/simulate-access\n                                     (+ 0x1000 (* (rand-int 1000) 64))]))}\n         \"Random\"]]])))\n\n;; =============================================================================\n;; Main Cache View\n;; =============================================================================\n\n(defn cache-view\n  \"Complete cache visualization view.\"\n  []\n  (let [cache-state @(rf/subscribe [::state/cache-state])\n        active-level (rf/subscribe [::state/current-tab])]\n    [:div.cache-view\n     [:div.view-header\n      [:h2 \"Cache Hierarchy\"]\n      [:p.hint \"Click any cache line to inspect. Colors show MESI state.\"]]\n\n     [hierarchy-overview]\n\n     [simulation-controls]\n\n     [:div.cache-tabs\n      [:button.tab {:class \"active\"} \"L1 Data\"]\n      [:button.tab \"L2\"]\n      [:button.tab \"L3\"]]\n\n     (when (:l1d cache-state)\n       [cache-level-view {:level :l1d :cache (:l1d cache-state)}])]))\n"]}