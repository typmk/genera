{"version":3,"sources":["observatory/views/processes.cljs"],"mappings":"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","names":["observatory.views.processes/format-bytes","bytes","observatory.views.processes/format-percent","pct","p__12814","map__12815","cljs.core/--destructure-map","cljs.core.get","observatory.views.processes/process-row","pid","name","cpu-percent","memory-bytes","threads","state","process","re-frame.core/dispatch","cljs.core._EQ_","e","x__5090__auto__","y__5091__auto__","cljs.core/name","or__5002__auto__","observatory.views.processes/sort-indicator","current-sort","column","observatory.views.processes/process-table","cljs.core/deref","processes","re_frame.core.subscribe","iter__5480__auto__","s__12817","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__12819","cljs.core/chunk-buffer","i__12818","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__12816","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","observatory.views.processes/summary-stats","total-cpu","cljs.core.reduce","cljs.core/+","cljs.core.map","total-memory","total-threads","observatory.views.processes/quick-actions","observatory.views.processes/processes-view","cljs.core/chunk-first"],"sourcesContent":["(ns observatory.views.processes\n  \"Process list view - the Task Manager surface.\n\n   Shows processes in a sortable table. Click any process to:\n   - Open inspector with process details\n   - Drill into memory regions, cache behavior, etc.\n\n   This is the entry point for progressive disclosure.\"\n  (:require [re-frame.core :as rf]\n            [observatory.state :as state]))\n\n;; =============================================================================\n;; Formatting Helpers\n;; =============================================================================\n\n(defn format-bytes\n  \"Format bytes as human-readable string.\"\n  [bytes]\n  (cond\n    (nil? bytes) \"-\"\n    (< bytes 1024) (str bytes \" B\")\n    (< bytes (* 1024 1024)) (str (int (/ bytes 1024)) \" KB\")\n    (< bytes (* 1024 1024 1024)) (str (int (/ bytes 1024 1024)) \" MB\")\n    :else (str (.toFixed (/ bytes 1024 1024 1024) 1) \" GB\")))\n\n(defn format-percent\n  \"Format percentage with one decimal.\"\n  [pct]\n  (if pct\n    (str (.toFixed pct 1) \"%\")\n    \"-\"))\n\n;; =============================================================================\n;; Process Row\n;; =============================================================================\n\n(defn process-row\n  \"A single process row. Clickable for inspection.\"\n  [{:keys [pid name cpu-percent memory-bytes threads state] :as process}]\n  [:tr.process-row\n   {:on-click #(rf/dispatch [::state/select {:type :process :data process}])\n    :class (when (= state :stopped) \"stopped\")}\n\n   ;; PID - clickable to drill into\n   [:td.pid\n    [:button.drill-link\n     {:on-click (fn [e]\n                  (.stopPropagation e)\n                  (rf/dispatch [::state/select {:type :process :data process}]))}\n     pid]]\n\n   ;; Name\n   [:td.name name]\n\n   ;; CPU - with visual bar\n   [:td.cpu\n    [:div.metric-cell\n     [:div.bar-bg\n      [:div.bar-fill.cpu {:style {:width (str (min cpu-percent 100) \"%\")}}]]\n     [:span.value (format-percent cpu-percent)]]]\n\n   ;; Memory - with visual bar\n   [:td.memory\n    [:div.metric-cell\n     [:div.bar-bg\n      [:div.bar-fill.memory {:style {:width (str (min (* (/ memory-bytes (* 4 1024 1024 1024)) 100) 100) \"%\")}}]]\n     [:span.value (format-bytes memory-bytes)]]]\n\n   ;; Threads\n   [:td.threads threads]\n\n   ;; State indicator\n   [:td.state\n    [:span.state-badge {:class (cljs.core/name (or state :running))}\n     (or state :running)]]])\n\n;; =============================================================================\n;; Process Table\n;; =============================================================================\n\n(defn sort-indicator\n  \"Shows sort direction arrow.\"\n  [current-sort column]\n  (when (= current-sort column)\n    [:span.sort-arrow \"\u25bc\"]))\n\n(defn process-table\n  \"Main process table with sortable columns.\"\n  []\n  (let [processes @(rf/subscribe [::state/processes-by-cpu])\n        ;; Local state for sorting would go here\n        current-sort :cpu-percent]\n    [:div.process-table-container\n     [:table.process-table\n      [:thead\n       [:tr\n        [:th.pid \"PID\"]\n        [:th.name \"Name\"]\n        [:th.cpu {:class \"sortable\"}\n         \"CPU\" [sort-indicator current-sort :cpu-percent]]\n        [:th.memory {:class \"sortable\"}\n         \"Memory\" [sort-indicator current-sort :memory-bytes]]\n        [:th.threads \"Threads\"]\n        [:th.state \"State\"]]]\n      [:tbody\n       (for [process processes]\n         ^{:key (:pid process)}\n         [process-row process])]]]))\n\n;; =============================================================================\n;; Summary Stats\n;; =============================================================================\n\n(defn summary-stats\n  \"Overview stats for all processes.\"\n  []\n  (let [processes @(rf/subscribe [::state/processes])]\n    (when (seq processes)\n      (let [total-cpu (reduce + 0 (map :cpu-percent processes))\n            total-memory (reduce + 0 (map :memory-bytes processes))\n            total-threads (reduce + 0 (map :threads processes))]\n        [:div.summary-stats\n         [:div.stat-card\n          [:div.stat-value (count processes)]\n          [:div.stat-label \"Processes\"]]\n         [:div.stat-card\n          [:div.stat-value (format-percent total-cpu)]\n          [:div.stat-label \"Total CPU\"]]\n         [:div.stat-card\n          [:div.stat-value (format-bytes total-memory)]\n          [:div.stat-label \"Total Memory\"]]\n         [:div.stat-card\n          [:div.stat-value total-threads]\n          [:div.stat-label \"Total Threads\"]]]))))\n\n;; =============================================================================\n;; Quick Actions\n;; =============================================================================\n\n(defn quick-actions\n  \"Action bar for process operations.\"\n  []\n  [:div.quick-actions\n   [:input.search-input\n    {:type \"text\"\n     :placeholder \"Filter processes...\"}]\n   [:div.action-buttons\n    [:button.btn \"Refresh\"]\n    [:button.btn \"Tree View\"]]])\n\n;; =============================================================================\n;; Main View\n;; =============================================================================\n\n(defn processes-view\n  \"Complete processes view - Task Manager style.\"\n  []\n  [:div.processes-view\n   [:div.view-header\n    [:h2 \"Processes\"]\n    [:p.hint \"Click any process to inspect. Drill into memory, cache, I/O.\"]]\n   [quick-actions]\n   [summary-stats]\n   [process-table]])\n"]}